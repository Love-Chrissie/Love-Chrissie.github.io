---
title: 一维稳态流动与扩散问题验证
abbrlink: 19049
date: 2018-10-10 22:22:14
categories:
tags:
---

### 控制一维稳态流动与扩散问题验证
考虑一段长为1m的区域，其稳态无源项的对流扩散方程如下：
$$\dfrac{d}{dx}(\rho u\phi)=\dfrac{d}{dx}(\Gamma\dfrac{d\phi}{dx})$$
流动还需满足连续性方程：
$$\dfrac{d(\rho u)}{dx}$$
![](/images/WX20181010-205935@2x.png)
积分上两式可得：
$$(\rho u A\phi)_e-(\rho u A\phi)_w=\big(\Gamma A\dfrac{d\phi}{dx}\big)_e-\big(\Gamma A\dfrac{d\phi}{dx}\big)_w\\\\
(\rho u)_e-(\rho u)_w=0$$
定义两变量
- $F=\rho u$ 表示单位面积对流通量
- $D=\frac{\Gamma}{\delta x}$ 表示通过单元面的扩导

所以积分的对流扩散方程可重新写为：
$F_w=(\rho u)_w,D_w=\frac{\Gamma_w}{\delta x_{WP}},F_e=(\rho u)_e,D_e=\frac{\Gamma_e}{\delta x_{PE}}.$

连续性方程为:
$F_e-F_w=0$

使用中心差分离散方程最后的形式为：
$$a_P \phi_P=a_W \phi_W+a_E \phi_E,\text{其中}a_W=D_w+\frac{F_w}{2},a_E=D_e-\frac{F_e}{2},a_P=a_E+a_W+(F_e-F_w)$$

本次算例解析解为：
$$\frac{\phi-\phi_0}{\phi_L-\phi_0}=\frac{\exp(\frac{\rho ux}{\Gamma})-1}{\exp(\frac{\rho uL}{\Gamma})-1}$$

边界条件为：$\phi_0=1$当$x=0$和$\phi_L=0$当$x=L$.
对边界点，其离散方程应改为：
- 对于第一个点，$-(a_P+a_W) \phi_P+a_E\phi_E+2a_W\phi_0=0 $
- 对于最后一个点，$a_W \phi_W-(a_P+a_E) \phi_P=0 $

三种情况验证：
1. u=0.1 m/s,节点数为5
2. u=2.5 m/s,节点数为5
3. u=2.5 m/s,节点数为20

得到三种图像如下：
![case1](/images/case1.png)
![case2](/images/case2.png)
![case3](/images/case3.png)

python代码如下：

```python
#!/usr/bin/env python  
# encoding: utf-8  
import numpy as np
import matplotlib.pyplot as plt
u = 2.5 # 流速
n=20 # 划分节点数（或者说控制体个数）
L = 1.0 # 总长度
rho = 1.0 # 密度
Gamma = 0.1 # 扩散系数

#解析解
x = np.linspace(0,1,100)
phi = np.array([(np.exp(rho*u*L/Gamma)-np.exp(rho*u*xx/Gamma))/(np.exp(rho*u*L/Gamma)-1) for xx in x])

#数值解
delta_x = L/n # 控制体边长
F = rho*u # 对流通量
D = Gamma/delta_x # 扩导
aW=D+F/2
aE=D-F/2
aP=aW+aE
A = -aP*np.ones(n)
B = np.zeros(n)
B[0] = -2*aW
A[0] = A[0]-aW
A[n-1] = A[n-1]-aE
#Thomas算法，并同时画图
#计算过程使用托马斯算法，这里由于生成的三对阵简答，没有使用通用的thomas算法，而是针对本算例进行了简化
for i in range(1,n):
    A[i] = A[i]-aW*aE/A[i-1]
    B[i] = B[i]-aW*B[i-1]/A[i-1]
B[n-1] = B[n-1]/A[n-1]
xx = np.linspace(delta_x/2,1-delta_x/2,n)
plt.scatter(xx[n-1], B[n-1], color='', marker='o', edgecolors='g', s=100, label='numerical solution')
for i in range(n-2,-1,-1):
    B[i] = (B[i]-aE*B[i+1])/A[i]
    plt.scatter(xx[i], B[i], color='', marker='o', edgecolors='g', s=100)

plt.scatter(0, 1, color='', marker='o', edgecolors='g', s=100) # 边界点
plt.scatter(1, 0, color='', marker='o', edgecolors='g', s=100) # 边界点
plt.plot(x,phi,label='analysis solution')
plt.rcParams['font.sans-serif']=['SimHei']
plt.xlabel(u"位置") # x轴名称
plt.ylabel(u"变量") # y轴名称
plt.title(u"一维稳态对流扩散问题") # 图名
plt.legend()
#plt.text() # 在图上自定位置处写下标记
#plt.axis([0,L,0,1]) # 设定坐标轴范围
plt.grid(True) # 开关网格
plt.savefig("case3.png")
plt.show() # 打印图像
```

---
