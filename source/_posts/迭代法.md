---
title: 求解线性方程组的迭代法
categories: 数学
tags: 矩阵与数值分析
abbrlink: 59676
date: 2018-11-06 09:28:45
---


### 一般迭代法
#### 引言

对于一般的线性方程组直接求解有高斯消去法，对称矩阵的Cholesky分解，三对角矩阵的Thomas算法。而计算过程中经常会遇到稀疏矩阵（矩阵的零元素远多于非零元素），使用高斯消去会将零元素变为非零元素，增加不必要的计算次数。而迭代法是一种求解线性方程组系数矩阵为稀疏矩阵时的高效算法。

通过将线性方程组
$$\boldsymbol{Ax}=\boldsymbol{b}$$
等价改写成
$$\boldsymbol{x}=\boldsymbol{Bx}+\boldsymbol{f}$$
便可得到迭代法：
$$\boldsymbol{x}^{(k+1)}=\boldsymbol{B}\boldsymbol{x}^{(k)}+\boldsymbol{f}$$
**定理**：迭代法
$$\boldsymbol{x}^{(k+1)}=\boldsymbol{B}\boldsymbol{x}^{(k)}+\boldsymbol{f}$$
对任意初始点$\boldsymbol{x}^{(0)}$和$\boldsymbol{f}$均收敛的充要条件是$\rho(\boldsymbol{B})<1$.

#### 雅可比(Jacobi)迭代
设一般形式的线性方程组如下：
$$
a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n=b_1,\\\\
a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n=b_2,\\\\
\cdots\\\\
a_{n1}x_1+a_{n2}x_2+\cdots+a_{nn}x_n=b_n
$$
将上述线性方程组作简单调整就可以得到Jacobi迭代公式了，将上述线性方程组写成如下形式：
$$\begin{align}
x_1&=\frac{1}{a_{1,1}}(b_1-a_{1,2}x_2-\cdots-a_{1,n}x_n)，\\\\
x_2&=\frac{1}{a_{2,2}}(b_2-a_{2,1}x_1-a_{2,3}x_3\cdots-a_{2,n}x_n),\\\\
\cdots\\\\
x_n&=\frac{1}{a_{n,n}}(b_n-a_{n,1}x_1-a_{n,2}x_2-\cdots-a_{n,n-1}x_{n-1})
\end{align}
$$
上述线性方程组左边视为新一时刻的值，那么这个新值就可以利用右边的旧值计算得到，于是得到的迭代格式即：
$$
x_{i}^{(k+1)}=x_{i}^{(k)}+\frac{1}{a_{ii}}\Big(b_i-\sum\limits_{j=1}^{n}a_{ij}x_{j}^{(k)}\Big)
$$
上式即为Jacobi迭代法。

设
$$\begin{align}\boldsymbol{D}&=\boldsymbol{diag}(a_{11},a_{22},\cdots,a_{nn}),\\\\
\boldsymbol{L}&=\begin{bmatrix}0 & & & & &0\\\\
-a_{21} & 0 & & & &\\\\
\vdots & \ddots & \ddots & & &\\\\
-a_{j1} & \cdots & -a_{j,j-1} & 0& &\\\\
\vdots &   & \vdots & \ddots & \ddots &  \\\\
-a_{n1} & \cdots & -a_{n,j-1} & \cdots & -a_{n,n-1} & 0
\end{bmatrix},\\\\
\boldsymbol{U}&=\begin{bmatrix}0 & -a_{12} & \cdots & -a_{1j} & \cdots & -a_{1n}\\\\
 & 0 & \ddots &\vdots & &\vdots\\\\
 &  & \ddots & -a_{j-1,j} & \cdots & -a_{j-1,n}\\\\
 &  &  & \ddots & \ddots & \vdots\\\\
 &  &  &  & 0 & -a_{n-1,n} \\\\
 0 &  &  &  &  & 0
\end{bmatrix},
\end{align}$$
则:
$$
\boldsymbol{A}=\boldsymbol{D}-\boldsymbol{L}-\boldsymbol{U}\\\\
\boldsymbol{D}\boldsymbol{x}=(\boldsymbol{L}+\boldsymbol{U})\boldsymbol{x}+\boldsymbol{b}\\\\
\boldsymbol{x}=\boldsymbol{D}^{-1}(\boldsymbol{L}+\boldsymbol{U})\boldsymbol{x}+\boldsymbol{D}^{-1}\boldsymbol{b}
$$
所以矩阵形式的Jacobi迭代即为:
$$
\boldsymbol{x}^{(k+1)}=\boldsymbol{D}^{-1}(\boldsymbol{L}+\boldsymbol{U})\boldsymbol{x}^{(k)}+\boldsymbol{D}^{-1}\boldsymbol{b}
$$

#### 高斯塞德尔(Gauss–Seidel)迭代
注意到Jacobi迭代计算每一个方程时都会产生新值，而这个新值就可以放到下一个方程里代替旧值计算，即原式：
$$\begin{align}
x_1^{(k+1)}&=\frac{1}{a_{1,1}}(b_1-a_{1,2}x_2^{(k)}-\cdots-a_{1,n}x_n^{(k)})，\\\\
x_2^{(k+1)}&=\frac{1}{a_{2,2}}(b_2-a_{2,1}x_1^{(k)}-a_{2,3}x_3^{(k)}\cdots-a_{2,n}x_n^{(k)}),\\\\
\cdots\\\\
x_n^{(k+1)}&=\frac{1}{a_{n,n}}(b_n-a_{n,1}x_1^{(k)}-a_{n,2}x_2^{(k)}-\cdots-a_{n,n-1}x_{n-1}^{(k)})
\end{align}
$$
修改为：
$$\begin{align}
x_1^{(k+1)}&=\frac{1}{a_{1,1}}(b_1-a_{1,2}x_2^{(k)}-\cdots-a_{1,n}x_n^{(k)})，\\\\
x_2^{(k+1)}&=\frac{1}{a_{2,2}}(b_2-a_{2,1}x_1^{(k+1)}-a_{2,3}x_3^{(k)}\cdots-a_{2,n}x_n^{(k)}),\\\\
\cdots\\\\
x_{n-1}^{(k+1)}&=\frac{1}{a_{n-1,n-1}}(b_{n-1}-a_{n-1,1}x_1^{(k+1)}-a_{n-1,2}x_2^{(k+1)}-\cdots-a_{n-1,n-2}x_{n-2}^{(k+1)}-a_{n-1,n}x_{n}^{(k)})\\\\
x_n^{(k+1)}&=\frac{1}{a_{n,n}}(b_n-a_{n,1}x_1^{(k+1)}-a_{n,2}x_2^{(k+1)}-\cdots-a_{n,n-1}x_{n-1}^{(k+1)})
\end{align}
$$
即：
$$
x_{i}^{(k+1)}=\frac{1}{a_{ii}}\Big(b_i-\sum\limits_{j=1}^{i-1}a_{ij}x_j^{(k+1)}-\sum\limits_{j=i+1}^{n}a_{ij}x_j^{(k)}\Big)$$
写成矩阵形式:
$$
\begin{align}
\begin{pmatrix}a_{11} & & &\\\\
 & a_{22} & & \\\\
  & & \ddots & \\\\
  & & & a_{nn}\end{pmatrix}\begin{pmatrix}x_{1}^{(k+1)}\\\\
   x_{2}^{(k+1)}\\\\
\vdots\\\\
x_{n}^{(k+1)}\end{pmatrix}&=
\begin{pmatrix}
0 & & &\\\\
-a_{21} & 0 & & \\\\
\vdots & \vdots & \ddots & \\\\
-a_{n1} & -a_{n2} &\cdots & 0\end{pmatrix}
\begin{pmatrix}
x_{1}^{(k+1)}\\\\
x_{2}^{(k+1)}\\\\
\vdots\\\\
x_{n}^{(k+1)}
\end{pmatrix}\\\\
&+\begin{pmatrix}
0 & -a_{12} & & -a_{1n}\\\\
  & 0 & \cdots & -a_{2n}\\\\
  & & \ddots & \vdots \\\\
  & & & 0\end{pmatrix}\begin{pmatrix}x_{1}^{(k)}\\\\
x_{2}^{(k)}\\\\
\vdots\\\\
x_{n}^{(k)}
\end{pmatrix}+
\begin{pmatrix}
b_1\\\\
b_2\\\\
\vdots\\\\
b_n
\end{pmatrix}
\end{align}$$

即：
$$
\boldsymbol{D}\boldsymbol{x}^{(k+1)}=\boldsymbol{L}\boldsymbol{x}^{(k+1)}+\boldsymbol{U}\boldsymbol{x}^{(k)}+\boldsymbol{b}\\\\
\boldsymbol{D}\boldsymbol{x}^{(k+1)}-\boldsymbol{L}\boldsymbol{x}^{(k+1)}=\boldsymbol{U}\boldsymbol{x}^{(k)}+\boldsymbol{b}\\\\
\boldsymbol{x}^{(k+1)}=(\boldsymbol{D}-\boldsymbol{L})^{-1}\boldsymbol{U}\boldsymbol{x}^{(k)}+(\boldsymbol{D}-\boldsymbol{L})^{-1}\boldsymbol{b}
$$
#### 连续过松弛(SOR)
高斯塞德尔迭代格式如下：

$$x_{i}^{(k+1)}=\frac{1}{a_{ii}}\Big(b_i-\sum\limits_{j=1}^{i-1}a_{ij}x_j^{(k+1)}-\sum\limits_{j=i+1}^{n}a_{ij}x_j^{(k)}\Big)$$



我们考虑上式右端和$x_i^{(k)}$的线性组合形式来计算$x_i^{(k+1)}$得到如下格式：

$$x_{i}^{(k+1)}=(1-\omega)x_{i}^{(k)}+\frac{\omega}{a_{ii}}\Big(b_i-\sum\limits_{j=1}^{i-1}a_{ij}x_j^{(k+1)}-\sum\limits_{j=i+1}^{n}a_{ij}x_j^{(k)}\Big)$$

以上即为超松弛格式(SOR)，其中$\omega$为松弛系数，调整松弛系数来加快迭代计算速度，当$\omega=1$时，即为高斯塞德尔迭代。

代码见:

[https://github.com/Love-Chrissie/numerical-computation/blob/master/%E8%BF%AD%E4%BB%A3%E6%B3%95/iterativeMethod.cpp](https://github.com/Love-Chrissie/numerical-computation/blob/master/%E8%BF%AD%E4%BB%A3%E6%B3%95/iterativeMethod.cpp)


### 一种特殊的迭代求解线性方程组的方法

#### 引言

我们要求解的线性方程组为$Ax=b$，注意到函数$G(x)=\frac{1}{2}x^T Ax-x^T b$达到极小值时满足$\frac{d G}{dx}=Ax-b=0$，所以我们将求解线性方程组转换成求解函数$G(x)=\frac{1}{2}x^T Ax-x^T b$的极小值。为了保证解的唯一性，我们要求系数矩阵$A$是正定且对称的，这样函数$G(x)$为凸函数，其局部最小值即为全局极小值且唯一。

综上，我们可以使用一些求解函数最小值的算法求解线性方程组$Ax=b$，下面只介绍一种算法：共轭梯度法。

#### 共轭梯度法

**共轭**   共轭可以理解成一种推广的向量正交，它指对于正定对称矩阵$A$，如果向量$u,v$满足$u^T Av=0$，则称向量$u,v$关于矩阵$A$共轭，显然向量$u,v$正交即向量$u,v$关于矩阵$I$共轭。

求解函数$G(x)$极小值过程为：

1. 选定初值$x_{0}$，初始搜索方向$s_{0}$，一般选为$s_{0}=-\nabla G(x_{0})$
2. 下一步迭代点由式$x_{k+1}=x_{k}+\lambda_{k} s_{k}$给出，其中$\lambda_{k}$由$\frac{d G(x_{k}+\lambda_{k} s_{k})}{d \lambda_{k}}=0$计算得到
3. 计算下一步搜索方向$s_{k+1}$
4. 重复上述过程直到满足收敛条件，如$\nabla G(x_k)=0$.

上述中$\lambda_{k}$表示第$k$步沿方向$s_{k}$的搜索步长，$\frac{d G(x_{k}+\lambda_{k} s_{k})}{d \lambda_{k}}=0$保证找到的步长使得函数减小最多。

**共轭梯度法**  就是选定一组共轭的搜索方向，这种选取方式能保证迭代最多$n$步就能收敛最小值。

**首先** 我们确定$\lambda_{k}$，$\lambda_{k}$由$\frac{d G(x_{k}+\lambda_{k} s_{k})}{d \lambda_{k}}=0$确定。
所以：
$$\begin{align}\frac{d G(x_{k}+\lambda_{k} s_{k})}{d \lambda_{k}}&=\nabla G(x_{k}+\lambda_{k} s_{(k)})^T s_{k}\\\\
&=[A(x_{k}+\lambda_{k} s_{k})]^T s_{k} -b^T s_{k}\\\\
&=x_{k}^T As_{k}+\lambda_{k}s_{k}^T A s_{k}-b^T s_{k}\\\\
&=0\\\\
\Longrightarrow \lambda_k&= \frac{(b^T-x_k^T A)s_k}{s_k^T A s_k}=\frac{s_k^T( b-Ax_k)}{s_k^T A s_k}
\end{align}
$$

**然后** 我们生成共轭方向作为每次迭代的搜索方向。我们可以将每次迭代计算得到的负梯度方向$=\nabla G(x)$作为初始方向，然后用类似[施密特正交化](https://en.wikipedia.org/wiki/Gram%E2%80%93Schmidt_process)的方式生成共轭方向。

每次迭代计算的负梯度为：$-\nabla G(x_k)=b-Ax_k=r_k$，对于线性方程组$Ax=b$来说，$b-Ax_k$为每步计算的残差，所以这里设为$r_k$。

类似施密特正交化我们得到共轭方向：

$$\begin{align}s_0&=r_0=b-Ax_0,\\\\
s_k&=r_k-\sum_{i<k}\frac{s_i^T A r_k}{s_i^T A s_i}s_i\end{align}$$

显然$s_j,\,(j=0,1,2...k)$相互关于$A$共轭，归纳显然。



**最后** 证明共轭梯度法最多$n$步收敛

$n$步收敛只需要证明$\nabla G(x_n)=0$即可。

$$\begin{align}\nabla G(x_n)&=Ax_n-b\\\\
&=A(x_{n-1}+\lambda_{n-1}s_{n-1})-b\\\\
&=\nabla G(x_{n-1})+\lambda_{n-1}As_{n-1}\\\\
&=\nabla G(x_{j})+\sum\limits_{i=j}^{n-1}\lambda_i A s_i
\end{align}$$

对上式右乘$s_j,\, j=0,1,2,...,n-1$
$$\begin{align}\therefore \nabla G(x_n)^T s_j
&=\nabla G(x_{j})^T s_j+\sum\limits_{i=j}^{n-1}\lambda_i s_i^T A s_j\\\\
&=\nabla G(x_{j})^T s_j+\lambda_j s_j^T A s_j\\\\
&=(\nabla G(x_{j})+\lambda_j  A s_j)^Ts_j\\\\
&=\nabla G(x_{j+1})^T s_j
\end{align}$$

注意到：

$$\frac{d G(x_j+\lambda s_j)}{d \lambda}=\nabla G(x_{j+1})^T s_j=0$$

有：

$$\nabla G(x_n)^T s_j=\nabla G(x_{j+1})^T s_j=0,\, j=0,1,2,...,n-1$$

对于一组$A$共轭向量$s_j,\, j=0,1,2,...,n-1$,$\nabla G(x_n)^T s_j=0$,显然$\nabla G(x_n)=0$,所以共轭梯度法最多$n$步收敛。

**程序计算步骤**：

$$\begin{align} &r_0 = b - Ax_0\\\\
&\text{如果} r_0\text{足够小, 就返回 } x_0\text{ 作为结果}\\\\
&s_0=r_0\\\\
&k=0\\\\
&\text{循环：}\\\\
&\qquad \alpha_k=\frac {r_k^T r_k}{s_k^T As_k}\\\\
&\qquad  x_{k+1}= x_k+\alpha_k s_k\\\\
&\qquad  r_{k+1}= r_k-\alpha_k As_k\\\\
&\qquad \text{如果} r_{k+1}\text{ 足够小, 就跳出循环}\\\\
&\qquad \beta_k={\frac { r_{k+1}^T r_{k+1}}{ r_k^T r_k}}\\\\
&\qquad  s_{k+1} = r_{k+1}+\beta_k s_k\\\\
&\qquad k=k+1\\\\
&\text{返回 } x_{k+1}\text{作为结果}
\end{align}$$




代码见:

[https://github.com/Love-Chrissie/numerical-computation/blob/master/%E8%BF%AD%E4%BB%A3%E6%B3%95/ConjugateGradient.py](https://github.com/Love-Chrissie/numerical-computation/blob/master/%E8%BF%AD%E4%BB%A3%E6%B3%95/ConjugateGradient.py)


---
