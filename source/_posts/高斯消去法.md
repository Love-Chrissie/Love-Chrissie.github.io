---
title: 高斯消去法
abbrlink: 42605
date: 2018-09-28 11:18:07
categories: 数学
tags: 矩阵与数值分析
---

高斯消去法与$LU$分解

高斯消去法思想就是通过初等行变换将系数矩阵变换成上三角矩阵，最后一行就解出了最后一个未知数的值，向上回带即可得到结果。

计算过程就是第二行开始每一行乘以第一行的$\lambda_{i}$倍，使得每一行第一个系数为0，然后对每一行做同样操作循环下去（下一次从第三行开始，使每一行第二个系数为0），使得系数矩阵变成上三角矩阵。最后回带每个未知量，求得结果。

例，对于线性方程组$\boldsymbol{Ax}=\boldsymbol{b}$，其中：
$$
 A=\begin{bmatrix}
   2 & 1 & 1 & 0 \\\\
   4 & 3 & 3 & 1 \\\\
   8 & 7 & 9 & 5 \\\\
   6 & 7 & 9 & 8
  \end{bmatrix},\quad
  b=\begin{bmatrix}
    4 \\\\
    11 \\\\
    29 \\\\
    30
   \end{bmatrix}.
$$
计算步骤：

$\begin{aligned}(\boldsymbol A |\boldsymbol b)&\xrightarrow{第一次消元}
\begin{bmatrix}
  2 & 1 & 1 & 0 & 4 \\\\
  0 & 1 & 1 & 1 & 3 \\\\
  0 & 3 & 5 & 5 & 13\\\\
  0 & 4 & 6 & 8 & 18
 \end{bmatrix}\xrightarrow{第二次消元}\begin{bmatrix}
   2 & 1 & 1 & 0 & 4 \\\\
   0 & 1 & 1 & 1 & 3 \\\\
   0 & 0 & 2 & 2 & 4\\\\
   0 & 0 & 2 & 4 & 6
  \end{bmatrix}\\\\&\xrightarrow{第三次消元}\begin{bmatrix}
    2 & 1 & 1 & 0 & 4 \\\\
    0 & 1 & 1 & 1 & 3 \\\\
    0 & 0 & 2 & 2 & 4\\\\
    0 & 0 & 0 & 2 & 2
   \end{bmatrix}=(\boldsymbol U|\boldsymbol c)\end{aligned}$

 解上三角方程组$\boldsymbol{Ux}=\boldsymbol{c}$，得方程组得解为$\boldsymbol{x}=(1,1,1,1)^{T}$.
 上述行变换可以用初等矩阵来描述：

 $\boldsymbol L_1\boldsymbol A =
 \begin{bmatrix}
   1 & 0 & 0 & 0 \\\\
   -2 & 1 & 0 & 0 \\\\
   -4 & 0 & 1 & 0 \\\\
   -3 & 0 & 0 & 1
  \end{bmatrix}
 \begin{bmatrix}
   2 & 1 & 1 & 0 \\\\
   4 & 3 & 3 & 1 \\\\
   8 & 7 & 9 & 5 \\\\
   6 & 7 & 9 & 8
  \end{bmatrix}=\begin{bmatrix}
    2 & 1 & 1 & 0 \\\\
    0 & 1 & 1 & 1 \\\\
    0 & 3 & 5 & 5 \\\\
    0 & 4 & 6 & 8
   \end{bmatrix}$

   $\begin{aligned}\boldsymbol L_2\boldsymbol L_1\boldsymbol A &=
   \begin{bmatrix}
     1 & 0 & 0 & 0 \\\\
     0 & 1 & 0 & 0 \\\\
     0 & -3 & 1 & 0 \\\\
     0 & -4 & 0 & 1
    \end{bmatrix}
   \begin{bmatrix}
     1 & 0 & 0 & 0 \\\\
     -2 & 1 & 0 & 0 \\\\
     -4 & 0 & 1 & 0 \\\\
     -3 & 0 & 0 & 1
    \end{bmatrix}
   \begin{bmatrix}
     2 & 1 & 1 & 0 \\\\
     4 & 3 & 3 & 1 \\\\
     8 & 7 & 9 & 5 \\\\
     6 & 7 & 9 & 8
    \end{bmatrix}\\\\&=
    \begin{bmatrix}
      1 & 0 & 0 & 0 \\\\
      -2 & 1 & 0 & 0 \\\\
      -4 & -3 & 1 & 0 \\\\
      -3 & -4 & 0 & 1
     \end{bmatrix}
     \begin{bmatrix}
      2 & 1 & 1 & 0 \\\\
      4 & 3 & 3 & 1 \\\\
      8 & 7 & 9 & 5 \\\\
      6 & 7 & 9 & 8
     \end{bmatrix}=
     \begin{bmatrix}
       2 & 1 & 1 & 0 \\\\
       0 & 1 & 1 & 1 \\\\
       0 & 0 & 2 & 2 \\\\
       0 & 0 & 2 & 4
      \end{bmatrix}\end{aligned}$

$\begin{aligned}\boldsymbol L_3\boldsymbol L_2\boldsymbol L_1\boldsymbol A &=
\begin{bmatrix}
  1 & 0 & 0 & 0 \\\\
  0 & 1 & 0 & 0 \\\\
  0 & 0 & 1 & 0 \\\\
  0 & 0 & -1 & 1
 \end{bmatrix}
      \begin{bmatrix}
        1 & 0 & 0 & 0 \\\\
        0 & 1 & 0 & 0 \\\\
        0 & -3 & 1 & 0 \\\\
        0 & -4 & 0 & 1
       \end{bmatrix}
      \begin{bmatrix}
        1 & 0 & 0 & 0 \\\\
        -2 & 1 & 0 & 0 \\\\
        -4 & 0 & 1 & 0 \\\\
        -3 & 0 & 0 & 1
       \end{bmatrix}
      \begin{bmatrix}
        2 & 1 & 1 & 0 \\\\
        4 & 3 & 3 & 1 \\\\
        8 & 7 & 9 & 5 \\\\
        6 & 7 & 9 & 8
       \end{bmatrix}\\\\
       &=
       \begin{bmatrix}
         1 & 0 & 0 & 0 \\\\
         -2 & 1 & 0 & 0 \\\\
         -4 & -3 & 1 & 0 \\\\
         -3 & -4 & -1 & 1
        \end{bmatrix}
        \begin{bmatrix}
         2 & 1 & 1 & 0 \\\\
         4 & 3 & 3 & 1 \\\\
         8 & 7 & 9 & 5 \\\\
         6 & 7 & 9 & 8
        \end{bmatrix}=
        \begin{bmatrix}
          2 & 1 & 1 & 0 \\\\
          0 & 1 & 1 & 1 \\\\
          0 & 0 & 2 & 2 \\\\
          0 & 0 & 0 & 2
         \end{bmatrix}=\boldsymbol U\end{aligned}$

所以：

$\boldsymbol A=\boldsymbol L \boldsymbol U=
\begin{bmatrix}
  1 & 0 & 0 & 0 \\\\
  2 & 1 & 0 & 0 \\\\
  4 & 3 & 1 & 0 \\\\
  3 & 4 & 1 & 1
 \end{bmatrix}
 \begin{bmatrix}
  2 & 1 & 1 & 0 \\\\
  0 & 1 & 1 & 1 \\\\
  0 & 0 & 2 & 2 \\\\
  0 & 0 & 0 & 2
 \end{bmatrix}$

高斯消去法先得到上三角矩阵再回代求解，而$LU$分解先对系数矩阵$A$分解成两上下三角矩阵，然后两次回代求解。一般编程语言的科学计算库都是使用$LU$分解求线性方程组。

**定理** 若$n$阶方阵逐次（左上角）主子式$det A_k\neq 0,k=1,2,\cdots,n$，则$A$可以分解为单位下三角矩阵和上三角矩阵。顺序Gauss消去法可以顺利进行。

 | 高斯消去法                           | $LU$分解                |
 | ---------------------------------- | ----------------------- |
 | $Ax=b\\\\ \quad\Downarrow\\\\Ux=c$ | $A=LU\\\\ Ly=b\\\\Ux=y$ |

> 如上讨论的是顺序Gauss消去法，即除数$A(k,k)$不为0，或者说除数不能为0。当我们遇到除数$A(k,k)$为0的时候就需要进行行交换，将$A(k,k)=0$时的k行换到下方去。

[《科学计算和C程序集》](https://book.douban.com/subject/4247269/)的高斯消去法代码：https://github.com/Love-Chrissie/numerical-computation/blob/master/gelim.c

python代码如下:
```python
import numpy as np

# 输入系数矩阵应以numpy中的array类型输入
# LU分解又称doolittle分解
def doolittle(a, n):
    # 主行
    l = np.eye(n)
    u = np.zeros((n, n))
    for i in range(n):
        for j in range(i + 1, n):
            # 乘子，用于消去第j行的i列
            a[j, i] = a[j, i] / a[i, i]
            # 对i+1...n-1列
            for k in range(i + 1, n):
                a[j, k] = a[j, k] - a[j, i] * a[i, k]  # 消元
    for i in range(n):
        for j in range(n):
            if (j < i):
                l[i, j] = a[i, j]  # 下三角矩阵
            else:
                u[i, j] = a[i, j]  # 上三角矩阵
    return a,l,u
```







---
