---
title: 二阶非齐次常系数线性微分方程解法
categories: 数学
tags: [常微分方程,数学物理方法]
abbrlink: 1642
date: 2018-12-29 14:40:41
---




高数中在求解形如$y''+py'+q=f(x)$的二阶常系数非齐次线性微分方程的时候，是分成各种情况，然后按照各种情况给出解的形式，高数书中都有讲到，这里不再赘述。可参考[链接](https://wenku.baidu.com/view/1ff60dd233d4b14e8524687a.html)。

这种机械记忆太困难了，然后我找找找就找到了求解该方程的一般方法——[常数变易法](https://en.wikipedia.org/wiki/Variation_of_parameters)。

常数变易法应该是个很熟悉的名词，在高数课本上推导一阶非齐次常系数线性微分方程的求解公式的时候就是用的该方法。在一般的高阶非齐次线性微分方程上，该方法同样适用。

#### 一阶非齐次线性微分方程

对于一阶齐次线性微分方程$y' + p(x)y = 0$，可以直接通过分离变量，直接积分得到通解：

$$\begin{aligned}
\frac{dy}{dx} + p(x)y = 0&\Rightarrow \frac{dy}{y}=-p(x)dx
\\\\&\Rightarrow \ln |y| =\int-p(x)dx
\\\\&\Rightarrow y = C_0 e^{\int-p(x)dx}
\end{aligned}$$

而求解一阶非齐次线性微分方程$y' + p(x)y = q(x)$，我们知道非齐次线性微分方程的通解=齐次方程的通解+非齐次方程的一个特解，我们只需将齐次方程通解的常系数$C_0$改成关于$x$的函数$C(x)$来求解非齐次方程的一个特解。

设非齐次方程的一个特解为$y$，齐次方程的通解为$y_c$，非齐次方程的一个特解为$y_p$，有：

$$y=y_c+y_p,,\quad y_c = C_0 e^{\int-p(x)dx},\quad y_p=C(x)e^{\int-p(x)dx}$$

下面计算$C(x)$:

将$y_p=C(x)e^{\int-p(x)dx}$代入微分方程$y' + p(x)y = q(x)$有:

$$\begin{align}
C ^ { \prime } &( x ) e ^ { - \int p ( x ) d x } - C ( x ) p ( x ) e ^ { - \int p ( x ) d x } + p ( x ) C ( x ) e ^ { - \int p ( x ) d x } = q ( x )\\\\ \Rightarrow &C ^ { \prime } ( x ) = e ^ { \int p ( x ) d x } q ( x )
\\\\ \Rightarrow &C ( x ) = \int e ^ { \int p ( x ) d x } q ( x ) dx + C_1
\\\\
\end{align}$$


$$\therefore y=y_c+y_p= e ^ { - \int p ( x ) d x }\Big(C _ { 0 }  + \int q ( x ) e ^ { \int p ( x ) d x } d x\Big)$$

#### 二阶非齐次线性微分方程

二阶齐次线性微分方程的通解形式为$y=C_1 u_1(x)+C_2 u_2(x)$，这里不赘述具体形式。和一阶非齐次方程求解一样的过程，我们使用常数变易法求二阶非齐次方程$y''+p(x)y'+q(x)y=f(x)$的一个特解。

令$y_p=A(x) u_1(x)+B(x) u_2(x)$，注意到这里有两个未知量$A(x),B(x)$，需要两个方程才能求解出，注意到对于齐次方程$A(x),B(x)$均为常数，所以我们添加另一个条件为$0=A'(x) u_1(x)+B'(x) u_2(x)$。

将$y_p=A(x) u_1(x)+B(x) u_2(x)$代入微分方程有：

$$
\begin{align}y'&=A'(x) u_1(x)+B'(x) u_2(x)+A(x) u_1'(x)+B(x)u_2'(x)
\\\\&=A(x) u_1'(x)+B(x)u_2'(x)
\\\\y''&=A'(x) u_1'(x)+B'(x)u_2'(x)+A(x) u_1''(x)+B(x)u_2''(x)\end{align}
$$

$$\begin{align}\therefore y''+py'+qy&=A ( x ) (u _ { 1 }'' +pu _ { 1 }' +qu _ { 1 })  + B ( x ) (u _ { 2 }'' +pu _ { 2 }' +qu _ { 2 }) \\\\&\quad+ A ^ { \prime } ( x ) u _ { 1 } ^ { \prime } ( x ) + B ^ { \prime } ( x ) u _ { 2 } ^ { \prime } ( x )\\\\
&=A ^ { \prime } ( x ) u _ { 1 } ^ { \prime } ( x ) + B ^ { \prime } ( x ) u _ { 2 } ^ { \prime } ( x )\\\\&=f(x)\end{align}$$

$\therefore$我们得到

$$
\begin{aligned}
A ^ { \prime } ( x ) u _ { 1 }  ( x ) + B ^ { \prime } ( x ) u _ { 2 } (x)&=0
\\\\A ^ { \prime } ( x ) u _ { 1 } ^ { \prime } ( x ) + B ^ { \prime } ( x ) u _ { 2 } ^ { \prime } ( x )&=f(x)
\end{aligned}
$$

解得：
$$A'(x)=-\frac{1}{W}u_2(x)f(x),\, B'(x)=\frac{1}{W}u_1(x)f(x)$$
即：
$$A(x)=\int_0^x-\frac{1}{W}u_2(t)f(t)dt+C_1,\, B(x)=\int_0^x\frac{1}{W}u_1(t)f(t)dt+C_2$$

其中$W$表示朗斯基行列式：

$$W(x)=\left|\begin{array}{cc}
    u_1(x) &    u_2(x)    \\\\
    u_1'(x) &    u_2'(x)  
\end{array}\right| $$




$$\therefore y=C_1 u_1(x)+C_2u_2(x)+\int_0^x\frac{u_1(t)u_2(x)-u_2(t)u_1(x)}{W}f(t)dt$$


#### 非齐次微分方程解的物理意义

设某个线性系统满足线性微分方程$\frac{d^2 x}{dt^2}+w^2x=f$，比如受驱弹簧谐振子。第一项表示谐振子的加速度，第二项表示弹簧拉伸的张力，右项表示单位质量受作用的外力。

我们考虑某$\tau$时刻到$\tau+d \tau$时刻的情况，外力从$\tau$时刻开始作用到$\tau+d \tau$时刻结束。在这个极短的时间里，谐振子没有来得及产生位移，所以有：
$$x^{(\tau)}|_{t=\tau+d \tau}=0$$
而根据冲量定理有，单位质量谐振子动量的变化等于该时间间隔内外力的冲量，有:

$$
x_t^{(\tau)}|_{t=\tau+d \tau}-x_t^{(\tau)}|_{t=\tau}=f(\tau) d \tau
$$
注意到在$\tau $外力刚开始作用，没有使动量(速度)产生变化，所以$x_t^{(\tau)}|_{t=\tau}=0$,所以有：
$$
x_t^{(\tau)}|_{t=\tau+d \tau}=f(\tau) d \tau
$$

综上对于二阶非齐次线性系统$\frac{d^2 x}{dt^2}+w^2x=f$的求解，可以转化为求解齐次方程，满足：
$$\frac{d^2 x^{(\tau)}}{dt^2}+w^2x^{(\tau)}=0,\,x^{(\tau)}(\tau+d\tau)=0,\,\frac{dx^{(\tau)}}{dt}{\Bigg|}_{\tau+d\tau}=f(\tau)d\tau$$

记$x^{(\tau)}(t)=u(t,\tau)d\tau$,则:

$$x(t)=\int_0^t u(t,\tau)d\tau$$

其中$u(t,\tau)$满足：

$$\frac{d^2 u}{dt^2}+w^2u=0,\,u(\tau)=0,\,u'(\tau)=f(\tau)$$

该公式称为冲量定理。

> 冲量定理在求解线性系统中有广泛应用，无论是常微分方程还是偏微分方程。





---
